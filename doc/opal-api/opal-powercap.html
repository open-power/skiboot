
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>OPAL Power Caps &#8212; skiboot 20e245a
 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OPAL_PRD_MSG" href="opal-prd-msg-113.html" />
    <link rel="prev" title="OPAL Power Shift Ratio" href="opal-power-shift-ratio.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="opal-prd-msg-113.html" title="OPAL_PRD_MSG"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="opal-power-shift-ratio.html" title="OPAL Power Shift Ratio"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">skiboot 20e245a
 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">OPAL API Documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="opal-power-caps">
<span id="opal-powercap"></span><h1>OPAL Power Caps<a class="headerlink" href="#opal-power-caps" title="Permalink to this headline">¶</a></h1>
<p>Each entity that can be power capped is described in the device tree,
see <a class="reference internal" href="../device-tree/ibm,opal/power-mgt/powercap.html#device-tree-ibm-opal-power-mgt-powercap"><span class="std std-ref">power-mgt/powercap</span></a>. The values for each
power cap aren’t in the device tree, but rather fetched using the
<a class="reference internal" href="#opal-get-powercap"><span class="std std-ref">OPAL_GET_POWERCAP</span></a> OPAL call. This is because there may be other
entities such as a service processor that can change the nature of the
power cap asynchronously to OPAL.</p>
<div class="section" id="opal-get-powercap">
<span id="id1"></span><h2>OPAL_GET_POWERCAP<a class="headerlink" href="#opal-get-powercap" title="Permalink to this headline">¶</a></h2>
<p>The OPAL_GET_POWERCAP call retreives current information on the power
cap.</p>
<p>For each entity that can be power capped, the device tree
binding indicates what handle should be passed for each of the power cap
properties (minimum possible, maximum possible, current powercap).</p>
<p>The current power cap must be between the minimium possible and maximum
possible power cap. The minimum and maximum values are dynamic to allow
for them possibly being changed by other factors or entities
(e.g. service processor).</p>
<p>The call can be asynchronus, where the token parameter is used to wait
for the completion.</p>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>u32</td>
<td>handle</td>
</tr>
<tr class="row-odd"><td>int</td>
<td>token</td>
</tr>
<tr class="row-even"><td>u32</td>
<td>*pcap</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><a class="reference internal" href="return-codes.html#opal-success"><span class="std std-ref">OPAL_SUCCESS</span></a></dt>
<dd>Success</dd>
<dt><a class="reference internal" href="return-codes.html#opal-parameter"><span class="std std-ref">OPAL_PARAMETER</span></a></dt>
<dd>Invalid pcap pointer</dd>
<dt><a class="reference internal" href="return-codes.html#opal-unsupported"><span class="std std-ref">OPAL_UNSUPPORTED</span></a></dt>
<dd>No support for reading powercap sensor</dd>
<dt><a class="reference internal" href="return-codes.html#opal-hardware"><span class="std std-ref">OPAL_HARDWARE</span></a></dt>
<dd>Unable to procced due to the current hardware state</dd>
<dt><a class="reference internal" href="return-codes.html#opal-async-completion"><span class="std std-ref">OPAL_ASYNC_COMPLETION</span></a></dt>
<dd>Request was sent and an async completion message will be sent with
token and status of the request.</dd>
</dl>
</div>
</div>
<div class="section" id="opal-set-powercap">
<span id="id2"></span><h2>OPAL_SET_POWERCAP<a class="headerlink" href="#opal-set-powercap" title="Permalink to this headline">¶</a></h2>
<p>The OPAL_SET_POWERCAP call sets a power cap.</p>
<p>For each entity that can be power capped, the device tree
binding indicates what handle should be passed for each of the power cap
properties (minimum possible, maximum possible, current powercap).</p>
<p>The current power cap must be between the minimium possible and maximum
possible power cap.</p>
<p>You cannot currently set the minimum or maximum power cap, and thus
OPAL_PERMISSION will be returned if it is attempted to set. In the
future, this may change - but for now, the correct behaviour for an
Operating System is to not attempt to set them.</p>
<div class="section" id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>::</dt>
<dd>u32 handle
int token
u32 pcap</dd>
</dl>
</div>
<div class="section" id="id4">
<h3>Returns<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><a class="reference internal" href="return-codes.html#opal-success"><span class="std std-ref">OPAL_SUCCESS</span></a></dt>
<dd>Success</dd>
<dt><a class="reference internal" href="return-codes.html#opal-parameter"><span class="std std-ref">OPAL_PARAMETER</span></a></dt>
<dd>Invalid powercap requested beyond powercap limits</dd>
<dt><a class="reference internal" href="return-codes.html#opal-unsupported"><span class="std std-ref">OPAL_UNSUPPORTED</span></a></dt>
<dd>No support for changing the powercap</dd>
<dt><a class="reference internal" href="return-codes.html#opal-permission"><span class="std std-ref">OPAL_PERMISSION</span></a></dt>
<dd>Hardware cannot take the request</dd>
<dt><a class="reference internal" href="return-codes.html#opal-async-completion"><span class="std std-ref">OPAL_ASYNC_COMPLETION</span></a></dt>
<dd>Request was sent and an async completion message will be sent with
token and status of the request.</dd>
<dt><a class="reference internal" href="return-codes.html#opal-hardware"><span class="std std-ref">OPAL_HARDWARE</span></a></dt>
<dd>Unable to procced due to the current hardware state</dd>
<dt><a class="reference internal" href="return-codes.html#opal-busy"><span class="std std-ref">OPAL_BUSY</span></a></dt>
<dd>Previous request in progress</dd>
<dt><a class="reference internal" href="return-codes.html#opal-internal-error"><span class="std std-ref">OPAL_INTERNAL_ERROR</span></a></dt>
<dd>Error in request response</dd>
<dt><a class="reference internal" href="return-codes.html#opal-timeout"><span class="std std-ref">OPAL_TIMEOUT</span></a></dt>
<dd>Timeout in request completion</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">OPAL Power Caps</a><ul>
<li><a class="reference internal" href="#opal-get-powercap">OPAL_GET_POWERCAP</a><ul>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#returns">Returns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#opal-set-powercap">OPAL_SET_POWERCAP</a><ul>
<li><a class="reference internal" href="#id3">Parameters</a></li>
<li><a class="reference internal" href="#id4">Returns</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="opal-power-shift-ratio.html"
                        title="previous chapter">OPAL Power Shift Ratio</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="opal-prd-msg-113.html"
                        title="next chapter">OPAL_PRD_MSG</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/opal-api/opal-powercap.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="opal-prd-msg-113.html" title="OPAL_PRD_MSG"
             >next</a> |</li>
        <li class="right" >
          <a href="opal-power-shift-ratio.html" title="OPAL Power Shift Ratio"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">skiboot 20e245a
 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >OPAL API Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2017, IBM, others.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>