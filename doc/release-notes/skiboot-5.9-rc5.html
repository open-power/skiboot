
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>skiboot-5.9-rc5 &#8212; skiboot 326a466
 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="skiboot-5.9.1" href="skiboot-5.9.1.html" />
    <link rel="prev" title="skiboot-5.9-rc4" href="skiboot-5.9-rc4.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="skiboot-5.9.1.html" title="skiboot-5.9.1"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="skiboot-5.9-rc4.html" title="skiboot-5.9-rc4"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">skiboot 326a466
 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Release Notes</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">skiboot-5.9-rc5</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="skiboot-5-9-rc5">
<span id="id1"></span><h1>skiboot-5.9-rc5<a class="headerlink" href="#skiboot-5-9-rc5" title="Permalink to this headline">¶</a></h1>
<p>skiboot v5.9-rc5 was released on Monday October 23rd 2017 approximately
32,000ft above somewhere north of Tucson, Arizona. It is the fifth
release candidate of skiboot 5.9, which will become the new stable release
of skiboot following the 5.8 release, first released August 31st 2017.</p>
<p>skiboot v5.9-rc5 contains all bug fixes as of <a class="reference internal" href="skiboot-5.4.8.html#skiboot-5-4-8"><span class="std std-ref">skiboot-5.4.8</span></a>
and <a class="reference internal" href="skiboot-5.1.21.html#skiboot-5-1-21"><span class="std std-ref">skiboot-5.1.21</span></a> (the currently maintained stable releases). We
do not currently expect to do any 5.8.x stable releases.</p>
<p>For how the skiboot stable releases work, see <a class="reference internal" href="../process/stable-skiboot-rules.html#stable-rules"><span class="std std-ref">Skiboot stable tree rules and releases</span></a> for details.</p>
<p>The current plan is to cut the final 5.9 very shortly, with skiboot 5.9
being for all POWER8 and POWER9 platforms in op-build v1.20 (Due October 18th,
so we’re running a bit behind there).
This release will be targetted to early POWER9 systems.</p>
<p>Over <a class="reference internal" href="skiboot-5.9-rc3.html#skiboot-5-9-rc3"><span class="std std-ref">skiboot-5.9-rc3</span></a>, we have the following changes:</p>
<ul>
<li><p>opal/hmi: Workaround Power9 hw logic bug for couple of TFMR TB errors.</p></li>
<li><p>opal/hmi: Fix TB reside and HDEC parity error recovery for power9</p></li>
<li><p>phb4: Escalate freeze to fence to avoid checkstop</p>
<p>Freeze events such as MMIO loads can cause the PHB to lose it’s
limited powerbus credits. If all credits are used and a further MMIO
will cause a checkstop.</p>
<p>To work around this, we escalate the troublesome freeze events to a
fence. The fence will cause a full PHB reset which resets the powerbus
credits and avoids the checkstop.</p>
</li>
<li><p>phb4: Update some init registers</p>
<p>New inits based on next PHB4 workbook. Increases some timeouts to
avoid some spurious error conditions.</p>
</li>
<li><p>phb4: Enable PHB MMIO in phb4_root_port_init()</p>
<p>Linux EEH flow is somewhat broken. It saves the PCIe config space of
the PHB on boot, which it then uses to restore on EEH recovery. It
does this to restore MMIO bars and some other pieces.</p>
<p>Unfortunately this save is done before any drivers are bound to
devices under the PHB. A number of other things are configured in the
PHB after drivers start, hence some configuration space settings
aren’t saved correctly. These include bus master and MMIO bits in the
command register.</p>
<p>Linux tried to hack around this in this linux commit
<code class="docutils literal notranslate"><span class="pre">bf898ec5cb</span></code> powerpc/eeh: Enable PCI_COMMAND_MASTER for PCI bridges
This sets the bus master bit but ignores the MMIO bit.</p>
<p>Hence we lose MMIO after a full PHB reset. This causes the next MMIO
access to the device to fail and for us to perform a PE freeze
recovery, which still doesn’t set the MMIO bit and hence we still
fail.</p>
<p>This works around this by forcing MMIO on during
phb4_root_port_init().</p>
<p>With this we can recovery from a PHB fence event on POWER9.</p>
</li>
<li><p>phb4: Reduce link degraded message log level to debug</p>
<p>If we hit this message we’ll retry and fix the problem. If we run out
of retries and can’t fix the problem, we’ll still print a log message
at error level indicating a problem.</p>
</li>
<li><p>phb4: Fix GEN3 for DD2.00</p>
<p>In this fix:  <code class="docutils literal notranslate"><span class="pre">62ac7631ae</span></code> “phb4: Fix PCIe GEN4 on DD2.1 and above”,
We fixed DD2.1 GEN4 but broke DD2.00 as GEN3.</p>
<p>This fixes DD2.00 back to GEN3. This time for sure!</p>
</li>
</ul>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="skiboot-5.9-rc4.html"
                        title="previous chapter">skiboot-5.9-rc4</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="skiboot-5.9.1.html"
                        title="next chapter">skiboot-5.9.1</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/release-notes/skiboot-5.9-rc5.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="skiboot-5.9.1.html" title="skiboot-5.9.1"
             >next</a> |</li>
        <li class="right" >
          <a href="skiboot-5.9-rc4.html" title="skiboot-5.9-rc4"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">skiboot 326a466
 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Release Notes</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">skiboot-5.9-rc5</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2017, IBM, others.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>